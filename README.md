# LiveMotion

> **ì‹¤ì‹œê°„ ì–¼êµ´ ì¶”ì  ê¸°ë°˜ Live2D ìºë¦­í„° ì• ë‹ˆë©”ì´ì…˜ Android ì•±**

ì „ë©´ ì¹´ë©”ë¼ì˜ ì–¼êµ´ ì¸ì‹ ë°ì´í„°ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ Live2D ìºë¦­í„°ì— ë§¤í•‘í•˜ì—¬,
ì‚¬ìš©ìì˜ í‘œì •ê³¼ ë¨¸ë¦¬ ì›€ì§ì„ì´ ê·¸ëŒ€ë¡œ ìºë¦­í„°ì— ë°˜ì˜ë˜ëŠ” Android ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤.

<br>

## ğŸ“± ìŠ¤í¬ë¦°ìƒ·

<table>
  <tr>
    <th>ìŠ¤í”Œë˜ì‹œ 1</th>
    <th>ìŠ¤í”Œë˜ì‹œ 2</th>
    <th>íƒ€ì´í‹€</th>
    <th>ì´ìš©ì•½ê´€</th>
  </tr>
  <tr>
    <td><img src="https://github.com/user-attachments/assets/9918e18e-50a3-487e-b599-f100c89378f0" width="200" /></td>
    <td><img src="https://github.com/user-attachments/assets/594e6a24-39e0-48bf-950d-420c0901e0a5" width="200" /></td>
    <td><img src="https://github.com/user-attachments/assets/3a75518e-5062-4711-94e8-360b5c1ee35d" width="200" /></td>
    <td><img src="https://github.com/user-attachments/assets/6e5b4193-7362-462c-ba7b-9e64cdaf6b42" width="200" /></td>
  </tr>
  <tr>
    <th>ì„¤ì •</th>
    <th>ëª¨ë¸ ì„ íƒ</th>
    <th>ë°°ê²½ ì„ íƒ</th>
    <th>ìŠ¤íŠœë””ì˜¤</th>
  </tr>
  <tr>
    <td><img src="https://github.com/user-attachments/assets/7aeb6a15-81ac-4e71-af03-8b7ac8ce4978" width="200" /></td>
    <td><img src="https://github.com/user-attachments/assets/01099845-04c0-4e5a-8e35-9a84f3ede561" width="200" /></td>
    <td><img src="https://github.com/user-attachments/assets/dd3c4a8d-b749-4c97-83a8-5b6db5d6cbe6" width="200" /></td>
    <td><img src="https://github.com/user-attachments/assets/158956f5-7bfd-4136-9494-e233e7f906a8" width="200" /></td>
  </tr>
  <tr>
    <th>ë…¹í™”</th>
    <th colspan="2">ê°€ë¡œ ëª¨ë“œ</th>
  </tr>
  <tr>
    <td><img src="https://github.com/user-attachments/assets/efdf511b-2e65-49a5-8731-678cf464719b" width="200" /></td>
    <td colspan="2"><img src="https://github.com/user-attachments/assets/9925c7b2-8f30-4f9a-b127-6c3218a0b5f7" width="412" /></td>
  </tr>
</table>

<br>

## âœ¨ ì£¼ìš” ê¸°ëŠ¥

| ê¸°ëŠ¥ | ì„¤ëª… |
|------|------|
| **ì‹¤ì‹œê°„ ì–¼êµ´ ì¶”ì ** | MediaPipe Face Landmarker(478 ëœë“œë§ˆí¬)ë¡œ ì–¼êµ´ ì›€ì§ì„ì„ ì‹¤ì‹œê°„ ê°ì§€ |
| **Live2D ìºë¦­í„° ë Œë”ë§** | Live2D Cubism SDKë¥¼ í™œìš©í•œ 2D ìºë¦­í„° ì‹¤ì‹œê°„ ë Œë”ë§ |
| **í‘œì • ë§¤í•‘** | ëˆˆ ê¹œë¹¡ì„, ì… ë²Œë¦¼, ë¨¸ë¦¬ íšŒì „(Yaw/Pitch/Roll), í™ì±„ ì¶”ì  ë“±ì„ Live2D íŒŒë¼ë¯¸í„°ì— ë§¤í•‘ |
| **ëª¨ë¸/ë°°ê²½ ì„ íƒ** | ë‚´ì¥ ëª¨ë¸ ë° SAFë¥¼ í†µí•œ ì™¸ë¶€ ëª¨ë¸ ë¶ˆëŸ¬ì˜¤ê¸°, ë‹¤ì–‘í•œ ë°°ê²½ ì„ íƒ |
| **ê°ì • & ëª¨ì…˜ ì¬ìƒ** | ëª¨ë¸ë³„ í‘œì •(.exp3.json) ë° ëª¨ì…˜(.motion3.json) íŒŒì¼ ì¬ìƒ |
| **í™”ë©´ ë…¹í™”** | ìŠ¤íŠœë””ì˜¤ í™”ë©´ì„ ì˜ìƒìœ¼ë¡œ ë…¹í™” |
| **ê°€ë¡œ/ì„¸ë¡œ ëª¨ë“œ** | ì„¸ë¡œ ë° ê°€ë¡œ ëª¨ë“œ ëª¨ë‘ ì§€ì›í•˜ëŠ” ë°˜ì‘í˜• UI |
| **ì„¤ì •** | í…Œë§ˆ(ì‹œìŠ¤í…œ/ë¼ì´íŠ¸/ë‹¤í¬), íŠ¸ë˜í‚¹ ê°ë„, EMA ìŠ¤ë¬´ë”© ê°•ë„ ì¡°ì ˆ |
| **GPU ê°€ì†** | MediaPipe GPU Delegateë¥¼ í†µí•œ í•˜ë“œì›¨ì–´ ê°€ì† (ìë™ í´ë°±) |

<br>

## ğŸ—ï¸ ì•„í‚¤í…ì²˜

**í´ë¦° ì•„í‚¤í…ì²˜** ê¸°ë°˜ì˜ **ë©€í‹°ëª¨ë“ˆ** êµ¬ì¡°ì™€ **MVI íŒ¨í„´**ì„ ì ìš©í•˜ì—¬ ì„¤ê³„í•˜ì˜€ìŠµë‹ˆë‹¤.

### ëª¨ë“ˆ ì˜ì¡´ì„± ê·¸ë˜í”„

```
app â†’ feature:home     â†’ core:ui
    â†’ feature:settings â†’ core:ui
                       â†’ core:storage
    â†’ feature:studio   â†’ core:tracking â†’ domain
                       â†’ core:live2d   â†’ live2d:framework â†’ Live2DCubismCore.aar
                       â†’ core:storage
                       â†’ core:ui
                       â†’ core:navigation
    â†’ core:common      â†’ core:tracking, core:storage (DI wiring)
    â†’ core:navigation
    â†’ domain
    â†’ data             â†’ core:storage, domain
```

### ëª¨ë“ˆë³„ ì—­í• 

| ëª¨ë“ˆ | ì—­í•  | ì–¸ì–´ |
|------|------|------|
| `app` | MainActivity, Navigation Host ì„¤ì • | Kotlin |
| `domain` | ìˆœìˆ˜ ë„ë©”ì¸ ëª¨ë¸, Repository ì¸í„°í˜ì´ìŠ¤, UseCase | Kotlin |
| `data` | Repository êµ¬í˜„ì²´, Hilt DI ëª¨ë“ˆ, Firebase Firestore ì—°ë™ | Kotlin |
| `core:tracking` | CameraX + MediaPipe ì–¼êµ´ ì¶”ì  | Kotlin |
| `core:live2d` | Live2D SDK ë˜í•‘, GLSurfaceView ê¸°ë°˜ ë Œë”ë§ | Kotlin + Java |
| `core:storage` | SAF ê¶Œí•œ ê´€ë¦¬, ëª¨ë¸ ìºì‹±, DataStore ê¸°ë°˜ ë¡œì»¬ ì €ì¥ì†Œ | Kotlin |
| `core:ui` | ê³µí†µ Compose Theme, ì¬ì‚¬ìš© UI ì»´í¬ë„ŒíŠ¸ | Kotlin |
| `core:navigation` | NavKey(Type-safe Navigation), Navigator ì¸í„°í˜ì´ìŠ¤ | Kotlin |
| `core:common` | App ë ˆë²¨ DI ëª¨ë“ˆ (ModelAssetReader, FaceTrackerFactory) | Kotlin |
| `feature:home` | ìŠ¤í”Œë˜ì‹œ, íƒ€ì´í‹€, ì´ìš©ì•½ê´€ í™”ë©´ | Kotlin |
| `feature:settings` | ì„¤ì • í™”ë©´ (í…Œë§ˆ, íŠ¸ë˜í‚¹ ê°ë„, ìŠ¤ë¬´ë”©) | Kotlin |
| `feature:studio` | ìŠ¤íŠœë””ì˜¤ (íŠ¸ë˜í‚¹ + ë Œë”ë§), ëª¨ë¸/ë°°ê²½ ì„ íƒ í™”ë©´ | Kotlin |
| `live2d:framework` | Live2D Cubism SDK Framework (ë²¤ë” ì½”ë“œ) | Java |

### ë°ì´í„° íë¦„

```
ì¹´ë©”ë¼ í”„ë ˆì„
    â†“
FaceTracker (CameraX + MediaPipe FaceLandmarker)
    â†“  StateFlow<FacePose>
MapFacePoseUseCase (EMA ìŠ¤ë¬´ë”© â†’ Live2DParams ë³€í™˜)
    â†“  Map<String, Float>
Live2DScreen (Compose â†” GLSurfaceView)
    â†“  queueEvent
LAppMinimumLive2DManager (Live2D SDK íŒŒë¼ë¯¸í„° ì ìš©)
    â†“
Live2D ìºë¦­í„° ë Œë”ë§
```

### MVI íŒ¨í„´

```kotlin
// UiState â€” ë‹¨ì¼ ìƒíƒœ í´ë˜ìŠ¤
data class StudioUiState(
    val isModelLoading: Boolean = true,
    val isZoomMode: Boolean = false, ...
)

// UiIntent â€” ì‚¬ìš©ì ì•¡ì…˜ ì •ì˜
sealed interface StudioUiIntent {
    data object ToggleZoom : StudioUiIntent
    data object ToggleRecord : StudioUiIntent
    ...
}

// UiEffect â€” ì¼íšŒì„± ì´ë²¤íŠ¸ (Snackbar, Navigation)
sealed class StudioUiEffect {
    data class ShowSnackbar(val message: String) : StudioUiEffect()
    ...
}
```

### Screen / Content ë¶„ë¦¬ íŒ¨í„´

```
StudioScreen (public)          â€” ViewModel ì—°ê²°, Effect ìˆ˜ì§‘, DI ì˜ì¡´
    â””â”€ StudioScreenContent (private)  â€” ìˆœìˆ˜ UI, @Preview ì§€ì›
         â””â”€ modelViewContent slot     â€” Live2DScreenì„ ìŠ¬ë¡¯ìœ¼ë¡œ ì£¼ì…
```

- **Screen**: `hiltViewModel()`, `collectAsStateWithLifecycle()` ë“± í”Œë«í¼ ì˜ì¡´ ë¡œì§
- **ScreenContent**: íŒŒë¼ë¯¸í„°(state, callback)ë§Œìœ¼ë¡œ ë™ì‘í•˜ëŠ” ìˆœìˆ˜ Composable, `@Preview` ê°€ëŠ¥
- ë„¤ì´í‹°ë¸Œ ì˜ì¡´ ì»´í¬ë„ŒíŠ¸ëŠ” `@Composable () -> Unit` ìŠ¬ë¡¯ íŒŒë¼ë¯¸í„°ë¡œ ì£¼ì…í•˜ì—¬ Previewì—ì„œ ëŒ€ì²´

<br>

## ğŸ› ï¸ ê¸°ìˆ  ìŠ¤íƒ

### Android & UI
- **Language**: Kotlin 2.2.0
- **Min SDK**: 26 / **Target SDK**: 36
- **UI Framework**: Jetpack Compose (BOM 2026.01.01)
- **Navigation**: Jetpack Navigation Compose + kotlinx.serialization (Type-safe Routes)
- **DI**: Hilt (Dagger)
- **ë¹„ë™ê¸° ì²˜ë¦¬**: Kotlin Coroutines + StateFlow

### ì¹´ë©”ë¼ & AI
- **Camera**: CameraX 1.5.3 (ì „ë©´ ì¹´ë©”ë¼)
- **Face Tracking**: MediaPipe Face Landmarker (478 ëœë“œë§ˆí¬ + Blendshapes)
- **GPU ê°€ì†**: MediaPipe GPU Delegate (ìë™ CPU í´ë°±)

### ë Œë”ë§
- **Live2D**: Cubism SDK for Native (Android AAR)
- **OpenGL ES**: GLSurfaceView ê¸°ë°˜ ì‹¤ì‹œê°„ ë Œë”ë§

### ë¡œì»¬ ì €ì¥ì†Œ & ë°±ì—”ë“œ
- **DataStore**: Preferences DataStore (í…Œë§ˆ, íŠ¸ë˜í‚¹ ì„¤ì •, ë™ì˜ ìƒíƒœ)
- **Firebase**: Firestore (ì´ìš©ì•½ê´€ ë™ì˜ ì¶”ì )
- **SAF**: Storage Access Framework (ì™¸ë¶€ ëª¨ë¸ íŒŒì¼ ì ‘ê·¼)

### ë¹Œë“œ
- **Build System**: Gradle Kotlin DSL
- **Code Generation**: KSP (Kotlin Symbol Processing)
- **Serialization**: kotlinx.serialization

<br>

## ğŸ“‚ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
LiveMotion/
â”œâ”€â”€ app/                          # MainActivity, Navigation ì„¤ì •
â”œâ”€â”€ domain/                       # ìˆœìˆ˜ Kotlin ë„ë©”ì¸ ë ˆì´ì–´
â”‚   â”œâ”€â”€ model/                    #   FacePose, Live2DParams, ExternalModel ë“±
â”‚   â”œâ”€â”€ repository/               #   Repository ì¸í„°í˜ì´ìŠ¤
â”‚   â””â”€â”€ usecase/                  #   MapFacePoseUseCase ë“±
â”œâ”€â”€ data/                         # ë°ì´í„° ë ˆì´ì–´
â”‚   â”œâ”€â”€ repository/               #   Repository êµ¬í˜„ì²´
â”‚   â””â”€â”€ di/                       #   Hilt DI ëª¨ë“ˆ
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ tracking/                 #   FaceTracker, FaceTrackerFactory
â”‚   â”œâ”€â”€ live2d/                   #   Live2DScreen, LAppMinimum* ë˜í¼
â”‚   â”œâ”€â”€ storage/                  #   DataStore, SAF, ëª¨ë¸ ìºì‹±
â”‚   â”œâ”€â”€ ui/                       #   Compose Theme, ê³µí†µ ì»´í¬ë„ŒíŠ¸
â”‚   â”œâ”€â”€ navigation/               #   NavKey, Navigator
â”‚   â””â”€â”€ common/                   #   AppModule (DI), ModelAssetReader
â”œâ”€â”€ feature/
â”‚   â”œâ”€â”€ home/                     #   IntroScreen, TitleScreen, TermsOfServiceScreen
â”‚   â”œâ”€â”€ settings/                 #   SettingsScreen
â”‚   â””â”€â”€ studio/                   #   StudioScreen, ModelSelectScreen
â”‚       â””â”€â”€ components/           #     FileListDialog, StudioIconButton ë“±
â””â”€â”€ live2d/framework/             # Live2D Cubism SDK Framework (ë²¤ë”)
```

<br>

## ğŸ–¥ï¸ í™”ë©´ êµ¬ì„±

| í™”ë©´ | ì„¤ëª… | ìŠ¤í¬ë¦°ìƒ· |
|------|------|----------|
| **ìŠ¤í”Œë˜ì‹œ** | ì•± ì•„ì´ì½˜ â†’ Live2D Cubism ë¡œê³  ìˆœì„œë¡œ í‘œì‹œ | ìŠ¤í¬ë¦°ìƒ· 1~2 |
| **íƒ€ì´í‹€** | Studio / Settings ì§„ì…ì , ì´ìš©ì•½ê´€ ë§í¬ | ìŠ¤í¬ë¦°ìƒ· 3 |
| **ì´ìš©ì•½ê´€** | Live2D SDK ë¼ì´ì„ ìŠ¤ ê´€ë ¨ ì´ìš©ì•½ê´€ ë™ì˜ | ìŠ¤í¬ë¦°ìƒ· 4 |
| **ì„¤ì •** | í…Œë§ˆ ëª¨ë“œ, ì–¸ì–´, íŠ¸ë˜í‚¹ ê°ë„(Yaw/Pitch/Roll), ìŠ¤ë¬´ë”© ê°•ë„ ì¡°ì ˆ | ìŠ¤í¬ë¦°ìƒ· 5 |
| **ëª¨ë¸ ì„ íƒ** | ë‚´ì¥/ì™¸ë¶€ ëª¨ë¸ ê·¸ë¦¬ë“œ, SAFë¡œ ì™¸ë¶€ ëª¨ë¸ ì¶”ê°€ | ìŠ¤í¬ë¦°ìƒ· 6 |
| **ë°°ê²½ ì„ íƒ** | ë‹¤ì–‘í•œ ë°°ê²½ ì´ë¯¸ì§€ ê·¸ë¦¬ë“œ, ì™¸ë¶€ ë°°ê²½ ì¶”ê°€ | ìŠ¤í¬ë¦°ìƒ· 7 |
| **ìŠ¤íŠœë””ì˜¤** | Live2D ë Œë”ë§ + ì–¼êµ´ ì¶”ì  ë¯¸ë¦¬ë³´ê¸°, ê°ì •/ëª¨ì…˜/ë…¹í™” ì»¨íŠ¸ë¡¤ | ìŠ¤í¬ë¦°ìƒ· 8~9 |
| **ê°€ë¡œ ëª¨ë“œ** | ê°€ë¡œ ë°©í–¥ ë°˜ì‘í˜• ë ˆì´ì•„ì›ƒ (ëª¨ë¸ ë·° + ì»¨íŠ¸ë¡¤ íŒ¨ë„) | ìŠ¤í¬ë¦°ìƒ· 10 |

<br>

## ğŸ”‘ í•µì‹¬ ê¸°ìˆ  í¬ì¸íŠ¸

### 1. ì‹¤ì‹œê°„ ì–¼êµ´ ì¶”ì  íŒŒì´í”„ë¼ì¸
- MediaPipe FaceLandmarkerì˜ 478ê°œ ëœë“œë§ˆí¬ì™€ Blendshapesë¥¼ í™œìš©
- `LIVE_STREAM` ëª¨ë“œë¡œ ì¹´ë©”ë¼ í”„ë ˆì„ë§ˆë‹¤ ì–¼êµ´ í¬ì¦ˆ ì¶”ì¶œ
- 5ì´ˆê°„ ìë™ ìº˜ë¦¬ë¸Œë ˆì´ì…˜ìœ¼ë¡œ ì¤‘ë¦½ í¬ì¦ˆ ê¸°ì¤€ì  ì„¤ì •
- GPU/CPU Delegate ìë™ ì „í™˜ ë° í´ë°± ì²˜ë¦¬

<details>
<summary>ğŸ“„ ì°¸ê³  ì½”ë“œ</summary>

**FaceLandmarker ì´ˆê¸°í™” ë° GPU ìë™ í´ë°±** â€” `core/tracking/FaceTracker.kt`

```kotlin
fun setupFaceLandmarker(useGpu: Boolean = true) {
    val requestedDelegate = if (useGpu) Delegate.GPU else Delegate.CPU
    val baseOptionsBuilder = BaseOptions.builder()
        .setDelegate(requestedDelegate)
        .setModelAssetPath("face_landmarker.task")
    try {
        val optionsBuilder = FaceLandmarker.FaceLandmarkerOptions.builder()
            .setBaseOptions(baseOptionsBuilder.build())
            .setRunningMode(RunningMode.LIVE_STREAM)
            .setResultListener { result, _ -> processResult(result) }
            .setNumFaces(1)
            .setOutputFaceBlendshapes(true)
        faceLandmarker = FaceLandmarker.createFromOptions(context, optionsBuilder.build())
    } catch (e: Exception) {
        // GPU ì´ˆê¸°í™” ì‹¤íŒ¨ ì‹œ CPUë¡œ ìë™ í´ë°±
        if (requestedDelegate == Delegate.GPU) {
            val cpuBaseOptions = BaseOptions.builder()
                .setDelegate(Delegate.CPU)
                .setModelAssetPath("face_landmarker.task")
            // ... CPUë¡œ ì¬ì´ˆê¸°í™”
        }
    }
}
```

**Blendshapes ê¸°ë°˜ í‘œì • ì¶”ì¶œ** â€” `core/tracking/FaceTracker.kt`

```kotlin
private fun calculatePose(landmarks: List<NormalizedLandmark>, scores: Map<String, Float>): FacePose {
    val nose = landmarks[4]; val leftEye = landmarks[33]; val rightEye = landmarks[263]
    // Yaw: ê±°ìš¸ ëª¨ë“œ ë°˜ì „, Zì¢Œí‘œ ê¹Šì´ ì°¨ì´ ê¸°ë°˜
    val yawNorm = -(rightEye.z() - leftEye.z()) * 15f
    // Pitch: ì½”ë-ì½” ë‹¤ë¦¬ Zì¢Œí‘œ ì°¨ì´ (ì›ê·¼ë²• ì™œê³¡ íšŒí”¼)
    val pitchZ = nose.z() - landmarks[6].z()
    // Blendshapesì—ì„œ ëˆˆÂ·ì… ìƒíƒœ ì¶”ì¶œ
    val eyeL = scores["eyeBlinkRight"] ?: 0f          // ê°ì€ ì •ë„
    val eyeWideL = scores["eyeWideRight"] ?: 0f       // í¬ê²Œ ëœ¬ ì •ë„
    val openL = (1f - eyeL) + (eyeWideL * 0.8f)       // ìµœì¢… ëˆˆ ëœ¬ ê°’
    val mouthRaw = scores["jawOpen"] ?: 0f
    val mouth = ((mouthRaw - 0.15f) / 0.85f).coerceIn(0f, 1f) // ë…¸ì´ì¦ˆ ì œê±°
    // Iris ëœë“œë§ˆí¬(468, 473)ë¡œ ì‹œì„  ì¶”ì 
    val (eyeBallX, eyeBallY) = calculateIrisPosition(landmarks)
    return FacePose(yaw = yawNorm, pitch = pitchZ * 15f, eyeLOpen = openL, mouthOpen = mouth, ...)
}
```

**5ì´ˆ ìë™ ìº˜ë¦¬ë¸Œë ˆì´ì…˜** â€” `core/tracking/FaceTracker.kt`

```kotlin
private fun processResult(result: FaceLandmarkerResult) {
    // ...
    if (!isCalibrated) {
        if (currentTime - calibrationStartTime < 5000) {
            // ì¤‘ë¦½ í¬ì¦ˆ ë°ì´í„° ìˆ˜ì§‘
            sumYaw += pose.yaw; sumPitch += pose.pitch; sumRoll += pose.roll
            calibrationSampleCount++
        } else {
            // ì˜¤í”„ì…‹ í™•ì •
            offsetYaw = sumYaw / calibrationSampleCount
            offsetPitch = sumPitch / calibrationSampleCount
            offsetRoll = sumRoll / calibrationSampleCount
            isCalibrated = true
        }
    }
    // ë³´ì • ì ìš©
    if (isCalibrated) {
        pose = pose.copy(
            yaw = pose.yaw - offsetYaw,
            pitch = pose.pitch - offsetPitch,
            roll = pose.roll - offsetRoll
        )
    }
}
```

</details>

### 2. ì–¼êµ´ â†’ Live2D íŒŒë¼ë¯¸í„° ë§¤í•‘
- `FacePose` â†’ `Live2DParams` ë³€í™˜ UseCase (ìˆœìˆ˜ í•¨ìˆ˜)
- EMA(ì§€ìˆ˜ì´ë™í‰ê· ) ìŠ¤ë¬´ë”©ìœ¼ë¡œ ìì—°ìŠ¤ëŸ¬ìš´ ì• ë‹ˆë©”ì´ì…˜ êµ¬í˜„
- ê±°ìš¸ ëª¨ë“œ: ì „ë©´ ì¹´ë©”ë¼ì˜ Yaw, Roll, EyeBallX ë¶€í˜¸ ë°˜ì „ ì²˜ë¦¬
- í™ì±„ ì¶”ì (Landmarks 468, 473)ìœ¼ë¡œ ì‹œì„  ë°©í–¥ ë°˜ì˜

<details>
<summary>ğŸ“„ ì°¸ê³  ì½”ë“œ</summary>

**ë„ë©”ì¸ ëª¨ë¸** â€” `domain/model/FacePose.kt`

```kotlin
data class FacePose(
    val yaw: Float = 0f,     // ì¢Œìš° íšŒì „ (-1.0 ~ 1.0)
    val pitch: Float = 0f,   // ìƒí•˜ íšŒì „
    val roll: Float = 0f,    // ê¸°ìš¸ê¸°
    val mouthOpen: Float = 0f,
    val mouthForm: Float = 0f,
    val eyeLOpen: Float = 1f,
    val eyeROpen: Float = 1f,
    val eyeBallX: Float = 0f, // ëˆˆë™ì ì¢Œìš° (-1 ~ 1)
    val eyeBallY: Float = 0f  // ëˆˆë™ì ìƒí•˜ (-1 ~ 1)
)
```

**EMA ìŠ¤ë¬´ë”© + Live2D íŒŒë¼ë¯¸í„° ë³€í™˜** â€” `domain/usecase/MapFacePoseUseCase.kt`

```kotlin
class MapFacePoseUseCase {
    // EMA: smoothed = lastValue + alpha * (newValue - lastValue)
    private fun smooth(last: Float, current: Float, alpha: Float): Float {
        return last + alpha * (current - last)
    }

    private fun map(newPose: FacePose, state: FacePoseSmoothingState, sensitivity: TrackingSensitivity)
        : Pair<Live2DParams, FacePoseSmoothingState> {
        val alpha = sensitivity.smoothing  // ê¸°ë³¸ê°’ 0.4f, ì„¤ì •ì—ì„œ ì¡°ì ˆ ê°€ëŠ¥
        val smoothed = FacePose(
            yaw = smooth(state.lastPose.yaw, newPose.yaw, alpha),
            pitch = smooth(state.lastPose.pitch, newPose.pitch, alpha),
            // ... ëª¨ë“  í•„ë“œì— EMA ì ìš©
        )
        val params = buildParams(smoothed, sensitivity)
        return Pair(Live2DParams(params), FacePoseSmoothingState(lastPose = smoothed))
    }

    private fun buildParams(smoothed: FacePose, sensitivity: TrackingSensitivity): Map<String, Float> {
        val params = mutableMapOf<String, Float>()
        // ë¨¸ë¦¬ íšŒì „ â†’ Live2D í‘œì¤€ ë²”ìœ„ (-30 ~ 30)
        params["ParamAngleX"] = (smoothed.yaw * 30f * sensitivity.yaw).coerceIn(-30f, 30f)
        params["ParamAngleY"] = (-smoothed.pitch * 40f * sensitivity.pitch).coerceIn(-30f, 30f)
        // ëˆˆ, ì…, ì‹œì„  íŒŒë¼ë¯¸í„°
        params["ParamEyeLOpen"] = smoothed.eyeLOpen.coerceIn(0f, 2f)
        params["ParamMouthOpenY"] = (smoothed.mouthOpen * 2.1f).coerceIn(0f, 2.1f)
        params["ParamEyeBallX"] = smoothed.eyeBallX.coerceIn(-1f, 1f)
        // ...
        return params
    }
}
```

</details>

### 3. Live2D ë Œë”ë§ ì•„í‚¤í…ì²˜
- Compose â†” GLSurfaceView ë¸Œë¦¿ì§€ (`queueEvent`ë¡œ ìŠ¤ë ˆë“œ ì•ˆì „ í†µì‹ )
- í•€ì¹˜ ì¤Œ / ë“œë˜ê·¸ ì œìŠ¤ì²˜ë¥¼ í†µí•œ ëª¨ë¸ í™•ëŒ€Â·ì´ë™
- ëª¨ë¸ë³„ í‘œì •Â·ëª¨ì…˜ ì—ì…‹ ë™ì  ê°ì§€ ë° ì¬ìƒ

<details>
<summary>ğŸ“„ ì°¸ê³  ì½”ë“œ</summary>

**Compose-GL ë¸Œë¦¿ì§€** â€” `core/live2d/Live2DScreen.kt`

```kotlin
@Composable
fun Live2DScreen(
    modelSource: ModelSource? = null,
    faceParams: Map<String, Float>? = null,
    effectFlow: Flow<Live2DUiEffect>? = null,
    // ...
) {
    val glView = remember { Live2DGLSurfaceView(context) }

    // ì–¼êµ´ íŒŒë¼ë¯¸í„° â†’ GL Threadë¡œ ì „ë‹¬
    LaunchedEffect(faceParams) {
        faceParams?.let { params ->
            glView.queueEvent {
                LAppMinimumLive2DManager.getInstance().applyFacePose(params)
            }
        }
    }

    // ëª¨ë¸ ë¡œë“œ â†’ GL Threadì—ì„œ ì‹¤í–‰, ê²°ê³¼ëŠ” Main Threadë¡œ ì „í™˜
    LaunchedEffect(modelSource) {
        modelSource?.let { source ->
            val mainHandler = Handler(Looper.getMainLooper())
            glView.queueEvent {
                LAppMinimumLive2DManager.getInstance().setOnModelLoadListener(
                    object : LAppMinimumLive2DManager.OnModelLoadListener {
                        override fun onModelLoaded() {
                            mainHandler.post { onModelLoaded?.invoke() }
                        }
                    }
                )
                LAppMinimumLive2DManager.getInstance().loadModel(source.modelId)
            }
        }
    }

    // Effect (í‘œì •/ëª¨ì…˜ ì¬ìƒ) â†’ GL Threadì—ì„œ ì²˜ë¦¬
    LaunchedEffect(effectFlow) {
        effectFlow?.collect { effect ->
            glView.queueEvent {
                when (effect) {
                    is Live2DUiEffect.StartExpression -> manager.startExpression(effect.path)
                    is Live2DUiEffect.StartMotion -> manager.startMotion(effect.path)
                    // ...
                }
            }
        }
    }

    AndroidView(factory = { glView })
}
```

</details>

### 4. ëª¨ë“ˆí™” & ì˜ì¡´ì„± ê´€ë¦¬
- ê³„ì¸µë³„ ì—„ê²©í•œ ì˜ì¡´ì„± ê·œì¹™ (`domain` â† `core` â† `feature` â† `app`)
- Hiltë¥¼ ì´ìš©í•œ ìƒì„±ì ì£¼ì…, ViewModelì—ì„œ Context ì˜ì¡´ì„± ì œê±°
- ê° ëª¨ë“ˆì˜ ë…ë¦½ì  ë¹Œë“œ ë° í…ŒìŠ¤íŠ¸ ê°€ëŠ¥

<details>
<summary>ğŸ“„ ì°¸ê³  ì½”ë“œ</summary>

**MVI íŒ¨í„´ ì ìš© ViewModel** â€” `feature/studio/StudioViewModel.kt`

```kotlin
@HiltViewModel
class StudioViewModel @Inject constructor(
    private val faceTrackerFactory: FaceTrackerFactory,  // Factory ì£¼ì…
    private val mapFacePoseUseCase: MapFacePoseUseCase,  // ìˆœìˆ˜ UseCase ì£¼ì…
    private val getModelMetadataUseCase: GetModelMetadataUseCase,
    // ...
) : ViewModel() {
    // State: ë‹¨ì¼ UI ìƒíƒœ ê°ì²´
    private val _uiState = MutableStateFlow(StudioUiState())
    val uiState: StateFlow<StudioUiState> = _uiState.asStateFlow()

    // Effect: ì¼íšŒì„± ì´ë²¤íŠ¸
    private val _uiEffect = Channel<StudioUiEffect>()
    val uiEffect = _uiEffect.receiveAsFlow()

    // Intent: ì‚¬ìš©ì ì•¡ì…˜ ì²˜ë¦¬
    fun onIntent(intent: StudioUiIntent) {
        when (intent) {
            is StudioUiIntent.ToggleGesture -> toggleGesture()
            is StudioUiIntent.SetGpuEnabled -> setGpuEnabled(intent.enabled)
            is StudioUiIntent.StartExpression -> startExpression(intent.path)
            // ...
        }
    }
}
```

**Screen/Content ë¶„ë¦¬ íŒ¨í„´** â€” `feature/studio/StudioScreen.kt`

```kotlin
// Screen (public): ViewModel + í”Œë«í¼ ì˜ì¡´ ë¡œì§
@Composable
fun StudioScreen(modelSource: ModelSource, viewModel: StudioViewModel = hiltViewModel()) {
    val facePose by viewModel.facePose.collectAsStateWithLifecycle()
    val uiState by viewModel.uiState.collectAsStateWithLifecycle()
    val faceParams = remember(facePose) { viewModel.mapFaceParams(facePose, ...) }

    StudioScreenContent(
        uiState = uiState,
        onIntent = viewModel::onIntent,
        modelViewContent = {
            Live2DScreen(faceParams = faceParams, modelSource = modelSource, ...)
        },
    )
}

// ScreenContent (private): ìˆœìˆ˜ UI, @Preview ì§€ì›
@Composable
private fun StudioScreenContent(
    uiState: StudioViewModel.StudioUiState,
    onIntent: (StudioUiIntent) -> Unit,
    modelViewContent: @Composable () -> Unit = {},  // ë„¤ì´í‹°ë¸Œ ë·°ë¥¼ ìŠ¬ë¡¯ìœ¼ë¡œ ì£¼ì…
) {
    // ìˆœìˆ˜ íŒŒë¼ë¯¸í„°ë§Œìœ¼ë¡œ ë™ì‘í•˜ëŠ” UI êµ¬ì„±
}
```

</details>

<br>

## ğŸ‘¤ ê°œë°œ ì •ë³´

- **ê°œë°œ ì¸ì›**: 1ì¸ ê°œë°œ
- **ê°œë°œ ê¸°ê°„**: 2025.01 ~ ì§„í–‰ ì¤‘
- **í”Œë«í¼**: Android

<br>

## ğŸ“„ ë¼ì´ì„ ìŠ¤

ì´ í”„ë¡œì íŠ¸ëŠ” [Live2D Cubism SDK](https://www.live2d.com/en/sdk/license/)ì˜ ë¼ì´ì„ ìŠ¤ ì •ì±…ì„ ë”°ë¦…ë‹ˆë‹¤.